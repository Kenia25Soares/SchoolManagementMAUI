<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:SchoolManagementMAUI.ViewModels"
             x:Class="SchoolManagementMAUI.Views.DashboardPage"
             Title="Dashboard">
    
    <Grid>
        <ScrollView>
            <VerticalStackLayout Padding="20" Spacing="20">
                <!-- Header com informações do utilizador -->
                <Frame Style="{StaticResource EducationalHeaderFrame}">
                    <VerticalStackLayout Spacing="15" HorizontalOptions="Center">
                        <Label Text="Welcome!" Style="{StaticResource EducationalWelcomeHeader}" />

                        <!-- Image profile -->
                        <Frame IsVisible="{Binding UserProfileImageUrl, Converter={StaticResource StringNotEmptyConverter}}"
                               CornerRadius="50" 
                               WidthRequest="100" 
                               HeightRequest="100" 
                               HorizontalOptions="Center"
                               Padding="0"
                               BackgroundColor="White">
                            <Image Source="{Binding UserProfileImageUrl}" 
                                   Aspect="AspectFill" />
                        </Frame>

                        <!-- Info User -->
                        <VerticalStackLayout Spacing="5" HorizontalOptions="Center">
                            <Label Text="{Binding UserName}" 
                                   Style="{StaticResource EducationalProfileName}"
                                   HorizontalOptions="Center" />

                            <Label Text="{Binding UserEmail}" 
                                   Style="{StaticResource EducationalProfileEmail}"
                                   HorizontalOptions="Center" />
                        </VerticalStackLayout>
                    </VerticalStackLayout>
                </Frame>

                <!-- Action Buttons -->
                <VerticalStackLayout Spacing="15">
                    <Button Text="My Grades" Command="{Binding OpenGradesCommand}" 
                            Style="{StaticResource EducationalPrimaryButton}" />

                    <Button Text="Request Additional Subjects" Command="{Binding OpenEnrollmentRequestsCommand}" 
                            Style="{StaticResource EducationalPrimaryButton}"
                            BackgroundColor="{StaticResource EducationalGreen}" />
                </VerticalStackLayout>
            </VerticalStackLayout>
        </ScrollView>

        <!-- Floating Notification Badge -->
        <Frame IsVisible="{Binding HasUnreadAlerts}"
               BackgroundColor="{StaticResource EducationalRed}"
               CornerRadius="8"
               Padding="0"
               HasShadow="False"
               HorizontalOptions="End"
               VerticalOptions="Start"
               Margin="0,10,10,0">
            <Label Text="{Binding UnreadAlertsCount}"
                   TextColor="White"
                   FontSize="10"
                   FontAttributes="Bold"
                   HorizontalOptions="Center"
                   VerticalOptions="Center" />
        </Frame>
    </Grid>

    <ContentPage.ToolbarItems>
            <!-- Notifications Bell -->
            <ToolbarItem Priority="0" Order="Primary" Command="{Binding OpenAlertsCommand}">
                <ToolbarItem.IconImageSource>
                    <FileImageSource File="icon_bell.svg" />
                </ToolbarItem.IconImageSource>
            </ToolbarItem>

            <!-- User Profile -->
            <ToolbarItem Priority="1" Order="Primary" Command="{Binding OpenProfileCommand}">
                <ToolbarItem.IconImageSource>
                <FileImageSource File="icon_user.svg" />
            </ToolbarItem.IconImageSource>
        </ToolbarItem>
    </ContentPage.ToolbarItems>

</ContentPage>